<html>
	<head>
	</head>

	<body>
		<div id="message1">init</div>
		<div id="message2"></div>
		<div id="message3"></div>
		<div id="message4"></div>
		

		<table style="width:100%;height:60%">
			<colgroup>
				<col width="33%">
				<col width="34%">
				<col width="33%">
			</colgroup>
			<tr style="height:50%">
				<td></td>
				<td style="background-color:green" id="rotate">rotate</td>
				<td></td>
			</tr>
			<tr style="height:50%">
				<td style="background-color:green" id="left">left</td>
				<td style="background-color:green" id="drop">drop</td>
				<td style="background-color:green" id="right">right</td>
			</tr>
		</table>

		<script src="/socket.io/socket.io.js"></script>
		<script src="/jquery.js"></script>

		<script>
			var socket = io.connect("/");

			var rotate=0;
			var left=0;
			var right=0;
			var drop=0;
			var connected=0;
			var player=0;
				
			socket.on('disconnect', function () {
				
				document.getElementById('message1').innerHTML = 'disconnected';
				document.getElementById('message2').innerHTML = '';
				connected=0;
				
			});

			socket.on('connect', function (transport) {
				
				document.getElementById('message1').innerHTML = 'connected';
				connected=1;
				
			});
			socket.on('player', function (data) {
				
				document.getElementById('message2').innerHTML = 'Player '+data;
				player=data;

			function updatekeys()
			{
				if(connected)
				{
					if(player > 0)
					{
						socket.emit('keys',rotate+left*2+right*4+drop*8);
					}
					
				}
			}

			$( "#rotate" ).mousedown(function() {
				rotate=1;
				this.style.backgroundColor='yellow';
				updatekeys();
			});
			$( "#rotate" ).mouseup(function() {
				rotate=0;
				this.style.backgroundColor='green';
				updatekeys();
			});
			$( "#rotate" ).mouseout(function() {
				rotate=0;
				this.style.backgroundColor='green';
				updatekeys();
			});

			$( "#right" ).mousedown(function() {
				right=1;
				this.style.backgroundColor='yellow';
				updatekeys();
			});
			$( "#right" ).mouseup(function() {
				right=0;
				this.style.backgroundColor='green';
				updatekeys();
			});
			$( "#right" ).mouseout(function() {
				right=0;
				this.style.backgroundColor='green';
				updatekeys();
			});

			$( "#left" ).mousedown(function() {
				left=1;
				this.style.backgroundColor='yellow';
				updatekeys();
			});
			$( "#left" ).mouseup(function() {
				left=0;
				this.style.backgroundColor='green';
				updatekeys();
			});
			$( "#left" ).mouseout(function() {
				left=0;
				this.style.backgroundColor='green';
				updatekeys();
			});

			$( "#drop" ).mousedown(function() {
				drop=1;
				this.style.backgroundColor='yellow';
				updatekeys();
			});
			$( "#drop" ).mouseup(function() {
				drop=0;
				this.style.backgroundColor='green';
				updatekeys();
			});
			$( "#drop" ).mouseout(function() {
				drop=0;
				this.style.backgroundColor='green';
				updatekeys();
			});

				
			});
		</script>

	</body>

</html>


